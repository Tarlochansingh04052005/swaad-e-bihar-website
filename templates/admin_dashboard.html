{% extends "admin_base.html" %}
{% block content %}
<div class="panel">
  <h2>Business Dashboard</h2>
  <p class="muted">Live snapshot of performance, demand, and customer health.</p>
  <div class="kpi-grid">
    <div class="kpi-card">
      <p class="muted">Today revenue</p>
      <p class="kpi-value">{{ kpis.today_revenue }}</p>
    </div>
    <div class="kpi-card">
      <p class="muted">Orders today</p>
      <p class="kpi-value">{{ kpis.orders_today }}</p>
    </div>
    <div class="kpi-card">
      <p class="muted">Avg order value</p>
      <p class="kpi-value">{{ kpis.avg_order_value }}</p>
    </div>
    <div class="kpi-card">
      <p class="muted">On-time rate</p>
      <p class="kpi-value">{{ kpis.on_time_rate }}</p>
    </div>
    <div class="kpi-card">
      <p class="muted">Repeat customers</p>
      <p class="kpi-value">{{ kpis.repeat_rate }}</p>
    </div>
    <div class="kpi-card">
      <p class="muted">Active menu items</p>
      <p class="kpi-value">{{ kpis.menu_items }}</p>
    </div>
  </div>
</div>

<div class="panel">
  <h2>Trends & Insights</h2>
  <div class="chart-grid">
    <div class="chart-card">
      <h3>Revenue (last 7 days)</h3>
      {% for row in revenue_trend %}
      <div class="trend-row">
        <span class="trend-label">{{ row.label }}</span>
        <div class="bar"><span class="bar-fill" data-width="{{ row.width }}"></span></div>
        <span class="trend-value">â‚¹{{ row.value | round(0) }}</span>
      </div>
      {% endfor %}
    </div>
    <div class="chart-card">
      <h3>Orders (last 7 days)</h3>
      {% for row in orders_trend %}
      <div class="trend-row">
        <span class="trend-label">{{ row.label }}</span>
        <div class="bar"><span class="bar-fill" data-width="{{ row.width }}"></span></div>
        <span class="trend-value">{{ row.value | int }}</span>
      </div>
      {% endfor %}
    </div>
    <div class="chart-card">
      <h3>Menu category mix</h3>
      {% for row in category_mix %}
      <div class="trend-row">
        <span class="trend-label">{{ row.label }}</span>
        <div class="bar"><span class="bar-fill" data-width="{{ row.width }}"></span></div>
        <span class="trend-value">{{ row.count }}</span>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<div class="panel">
  <h2>Quick Actions</h2>
  <div class="grid">
    <div class="panel">
      <h3>Clear all orders</h3>
      <p class="muted">Remove every order from the system.</p>
      <form method="post" action="/admin/orders/clear">
        <button class="btn danger" type="submit">Clear Orders</button>
      </form>
    </div>
    <a class="panel" href="/admin/orders">
      <h3>Orders</h3>
      <p class="muted">Add orders and update delivery status.</p>
    </a>
    <a class="panel" href="/admin/menu">
      <h3>Menu Items</h3>
      <p class="muted">Add or edit dishes, prices, and categories.</p>
    </a>
    <a class="panel" href="/admin/story">
      <h3>Story Content</h3>
      <p class="muted">Update highlights and the info panel.</p>
    </a>
    <a class="panel" href="/admin/contact">
      <h3>Contact Info</h3>
      <p class="muted">Update phone, email, location, and WhatsApp link.</p>
    </a>
    <a class="panel" href="/admin/users">
      <h3>Admin Users</h3>
      <p class="muted">Add or reset admin login accounts.</p>
    </a>
  </div>
</div>
{% endblock %}

{% extends "admin_base.html" %}
{% block content %}
<div class="panel">
  <h2>Admin Users</h2>
  <p class="muted">Add new admins or reset passwords.</p>
  {% if error %}
  <p class="badge">{{ error }}</p>
  {% endif %}
  <form method="post">
    <div class="grid">
      <div class="field">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" required />
      </div>
      <div class="field">
        <label for="password">Password</label>
        <input id="password" name="password" type="password" required />
      </div>
    </div>
    <button class="btn" type="submit">Add Admin</button>
  </form>
</div>

<div class="panel">
  <h2>Current Admins</h2>
  <table>
    <thead>
      <tr>
        <th>Email</th>
        <th>Created</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr>
        <td>{{ user.email }}</td>
        <td>{{ user.created_at }}</td>
        <td class="actions">
          <a class="btn secondary" href="/admin/users/{{ user.id }}/edit">Reset Password</a>
          {% if session.get("admin_user_id") != user.id %}
          <form method="post" action="/admin/users/{{ user.id }}/delete">
            <button class="btn" type="submit">Delete</button>
          </form>
          {% else %}
          <span class="muted">Signed in</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
